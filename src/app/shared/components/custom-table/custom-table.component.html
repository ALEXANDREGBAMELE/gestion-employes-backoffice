<div class="p-4">
    <button (click)="refreshData()" class="mb-4 bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">
        Rafraîchir
    </button>

    <div *ngIf="loading" class="text-center text-lg text-gray-600">Chargement...</div>

    <table *ngIf="!loading" class="min-w-full border border-gray-300">
        <thead class="bg-gray-200">
            <tr>
                <th *ngIf="showIndex" class="border px-4 py-2">#</th>
                <th *ngIf="showCheckbox" class="border px-4 py-2">
                    <input type="checkbox" />
                </th>
                <th *ngFor="let column of columns" class="px-4 py-2 text-left border-b border-gray-300">
                    {{ column.title }}
                </th>
                <th *ngIf="actionButtons.length > 0" class="border px-4 py-2">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let item of paginatedData; let i = index" class="hover:bg-gray-100">
                <td *ngIf="showIndex" class="border px-4 py-2">{{ i + 1 }}</td>
                <td *ngIf="showCheckbox" class="border px-4 py-2">
                    <input type="checkbox" />
                </td>

                <!-- Gestion dynamique du type de contenu -->
                <td *ngFor="let column of columns" class="px-4 py-2 border-b border-gray-300">
                    <ng-container [ngSwitch]="column.type">
                        <!-- Texte avec badge si nécessaire -->
                        <ng-container *ngSwitchDefault>
                            <ng-container *ngIf="isBadgeColumn(column.key); else normalText">
                                <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full"
                                    [ngClass]="getBadgeClass(column.key, item[column.key])">
                                    {{ item[column.key] }}
                                </span>
                            </ng-container>
                            <ng-template #normalText>
                                {{ item[column.key] }}
                            </ng-template>
                        </ng-container>

                        <!-- Image -->
                        <ng-container *ngSwitchCase="'image'">
                            <img [src]="item[column.key]" alt="Image" class="h-10 w-10 object-cover" />
                        </ng-container>

                        <!-- Fichier -->
                        <ng-container *ngSwitchCase="'file'">
                            <a [href]="item[column.key]" download class="text-blue-500 underline">
                                Télécharger le fichier
                            </a>
                        </ng-container>

                        <!-- Vidéo -->
                        <ng-container *ngSwitchCase="'video'">
                            <video controls [src]="item[column.key]" class="h-20 w-20">
                                Vidéo non prise en charge
                            </video>
                        </ng-container>

                        <!-- Audio -->
                        <ng-container *ngSwitchCase="'audio'">
                            <audio controls [src]="item[column.key]">
                                Audio non pris en charge
                            </audio>
                        </ng-container>

                        <!-- Lien -->
                        <ng-container *ngSwitchCase="'link'">
                            <a [href]="item[column.key]" target="_blank" class="text-blue-500 underline">
                                {{ item[column.key] }}
                            </a>
                        </ng-container>

                        <!-- Cas par défaut -->
                        <!-- <ng-container *ngSwitchDefault>
                            {{ item[column.key] }}
                        </ng-container> -->
                    </ng-container>
                </td>

        
                
                <!-- Actions -->
                <td *ngIf="actionButtons.length > 0" class="border px-4 py-2">
                    <ng-container *ngFor="let button of actionButtons">
                        <button (click)="button.action(item)" class="bg-blue-500 text-white py-1 px-2 rounded">
                            {{ button.label }}
                        </button>
                    </ng-container>
                </td>
            </tr>

            <tr *ngIf="paginatedData.length === 0">
                <td colspan="100%" class="px-4 py-2 text-center text-gray-500">{{ noDataMessage }}</td>
            </tr>
        </tbody>
    </table>

    <!-- Pagination -->
    <div *ngIf="totalPages > 1" class="mt-4 flex justify-between items-center">
        <button (click)="onPageChange(currentPage - 1)" [disabled]="currentPage === 1"
            class="bg-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-400 disabled:opacity-50">
            Précédent
        </button>
        <span>{{ currentPage }} / {{ totalPages }}</span>
        <button (click)="onPageChange(currentPage + 1)" [disabled]="currentPage === totalPages"
            class="bg-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-400 disabled:opacity-50">
            Suivant
        </button>
    </div>
</div>